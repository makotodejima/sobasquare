import React from "react";
import { Route } from "react-router-dom";
import { Flipper, Flipped } from "react-flip-toolkit";

import ListItem from "./ListItem";
import ExpandedListItem from "./ExpandedListItem";
import Detail from "./Detail";
import sobayas from "../data/sobayas.js";

class List extends React.Component {
  state = {
    selected: undefined
  };

  handleClick = (e, index) => {
    if (e.target.tagName === "A") return;

    this.setState({
      selected: this.state.selected === index ? null : index
    });
  };

  render() {
    const { selected } = this.state;

    return (
      <div>
        <div
          style={{
            width: `80px`,
            height: `80px`,
            margin: `3rem auto 3rem`
          }}
        >
          <svg
            id="Layer_1"
            data-name="Layer 1"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 78.5 82.5"
          >
            <title>sobasquare</title>
            <g>
              <g>
                <line
                  class="cls-1"
                  x1="63.79"
                  y1="40.75"
                  x2="63.79"
                  y2="0.07"
                />
                <line class="cls-1" x1="14.7" y1="82.43" x2="14.7" y2="25.34" />
                <line
                  class="cls-1"
                  x1="78.25"
                  y1="67.16"
                  x2="20.16"
                  y2="67.16"
                />
                <line
                  class="cls-1"
                  x1="58.34"
                  y1="16.25"
                  x2="0.25"
                  y2="16.25"
                />
                <line
                  class="cls-2"
                  x1="58.34"
                  y1="20.79"
                  x2="0.25"
                  y2="20.79"
                />
                <line
                  class="cls-2"
                  x1="78.25"
                  y1="62.61"
                  x2="20.16"
                  y2="62.61"
                />
              </g>
              <g>
                <path d="M24.35,37.17a2.92,2.92,0,0,0,.72-.07,1.35,1.35,0,0,0,.45-.2.58.58,0,0,0,.24-.3,1.12,1.12,0,0,0,.07-.38.85.85,0,0,0-.43-.74A5.89,5.89,0,0,0,24,34.84c-.29-.11-.59-.23-.89-.37a3.08,3.08,0,0,1-.81-.51,2.69,2.69,0,0,1-.58-.75,2.36,2.36,0,0,1-.22-1.08A2.64,2.64,0,0,1,21.69,31a2.34,2.34,0,0,1,.67-.86,3.08,3.08,0,0,1,1.05-.55,4.69,4.69,0,0,1,1.4-.19,5.77,5.77,0,0,1,1.6.2,6,6,0,0,1,1.1.43l-.59,1.63a4.71,4.71,0,0,0-.85-.35,3.7,3.7,0,0,0-1.13-.16,2,2,0,0,0-1.06.21.7.7,0,0,0-.32.63.74.74,0,0,0,.12.42,1.42,1.42,0,0,0,.33.31,4.66,4.66,0,0,0,.5.25l.63.23a11.94,11.94,0,0,1,1.24.52,3.41,3.41,0,0,1,.88.6,2.35,2.35,0,0,1,.52.8A3.38,3.38,0,0,1,28,36.23a2.38,2.38,0,0,1-.9,2,4.31,4.31,0,0,1-2.7.7,7.22,7.22,0,0,1-1.09-.07,7.33,7.33,0,0,1-.87-.18,4.72,4.72,0,0,1-.64-.22c-.18-.08-.34-.15-.46-.22l.58-1.64a5,5,0,0,0,2.48.58Z" />
                <path d="M38.24,34.16a5.72,5.72,0,0,1-.35,2.07,4.45,4.45,0,0,1-1,1.49,3.91,3.91,0,0,1-1.44.9,5.31,5.31,0,0,1-1.8.3,5.14,5.14,0,0,1-1.77-.3,3.94,3.94,0,0,1-1.45-.9,4.21,4.21,0,0,1-1-1.49,5.51,5.51,0,0,1-.35-2.07,5.26,5.26,0,0,1,.37-2.06,4.36,4.36,0,0,1,1-1.5A4.29,4.29,0,0,1,32,29.69a5.05,5.05,0,0,1,1.74-.3,5.12,5.12,0,0,1,1.76.3,4.1,4.1,0,0,1,1.45.91,4.34,4.34,0,0,1,1,1.5A5.45,5.45,0,0,1,38.24,34.16Zm-7,0a4.19,4.19,0,0,0,.16,1.22,2.73,2.73,0,0,0,.48.93,2.11,2.11,0,0,0,.76.6,2.4,2.4,0,0,0,1,.21,2.45,2.45,0,0,0,1-.21,2,2,0,0,0,.76-.6,2.73,2.73,0,0,0,.48-.93,4.19,4.19,0,0,0,.16-1.22A4.29,4.29,0,0,0,36,32.94a2.73,2.73,0,0,0-.48-.93,2,2,0,0,0-.76-.6,2.45,2.45,0,0,0-1-.21,2.26,2.26,0,0,0-1,.22,2.11,2.11,0,0,0-.76.6,2.69,2.69,0,0,0-.48.94A4.15,4.15,0,0,0,31.26,34.16Z" />
                <path d="M43,38.86c-.51,0-1,0-1.5,0A11,11,0,0,1,40,38.6V29.73a13,13,0,0,1,1.38-.17c.5,0,1-.06,1.4-.06a9.83,9.83,0,0,1,1.6.12,4,4,0,0,1,1.26.43,2.14,2.14,0,0,1,1.12,2,2,2,0,0,1-1.05,1.73,2.15,2.15,0,0,1,1.19.89A2.61,2.61,0,0,1,47.16,36a2.44,2.44,0,0,1-1,2.16A5.39,5.39,0,0,1,43,38.86Zm-1-5.67h1a2.66,2.66,0,0,0,1.35-.25.82.82,0,0,0,.41-.78.81.81,0,0,0-.42-.78,2.7,2.7,0,0,0-1.24-.22h-.57l-.54,0Zm0,1.57v2.36l.49,0H43a3.65,3.65,0,0,0,1.49-.26,1,1,0,0,0,.57-1,1,1,0,0,0-.48-.9,2.75,2.75,0,0,0-1.35-.27Z" />
                <path d="M54.81,38.74c-.1-.32-.21-.64-.33-1s-.23-.67-.35-1H50.56c-.11.34-.23.67-.34,1s-.23.66-.33,1H47.76c.34-1,.67-1.89,1-2.73s.62-1.62.91-2.36.59-1.44.87-2.1.59-1.32.9-1.95h2c.3.63.59,1.28.88,1.95s.59,1.36.89,2.1.59,1.53.9,2.36.64,1.75,1,2.73Zm-2.47-7.07c-.05.13-.11.32-.2.54s-.19.5-.3.8l-.38,1c-.14.36-.28.74-.43,1.14h2.61c-.14-.4-.27-.78-.4-1.14s-.26-.69-.38-1-.22-.56-.31-.79S52.39,31.8,52.34,31.67Z" />
                <path d="M24.35,53a2.86,2.86,0,0,0,.72-.08,1.35,1.35,0,0,0,.45-.19.67.67,0,0,0,.24-.3,1.17,1.17,0,0,0,.07-.38.88.88,0,0,0-.43-.75A5.89,5.89,0,0,0,24,50.66a9.22,9.22,0,0,1-.89-.36,3.4,3.4,0,0,1-.81-.52,2.43,2.43,0,0,1-.58-.75A2.32,2.32,0,0,1,21.45,48a2.64,2.64,0,0,1,.24-1.14,2.37,2.37,0,0,1,.67-.87,3.07,3.07,0,0,1,1.05-.54,4.69,4.69,0,0,1,1.4-.2,5.77,5.77,0,0,1,1.6.2,5.34,5.34,0,0,1,1.1.44l-.59,1.62a5.57,5.57,0,0,0-.85-.35A3.73,3.73,0,0,0,24.94,47a2.16,2.16,0,0,0-1.06.2.71.71,0,0,0-.32.63.7.7,0,0,0,.12.42,1.1,1.1,0,0,0,.33.31,3.33,3.33,0,0,0,.5.25c.19.08.4.15.63.23.48.18.89.35,1.24.52a4,4,0,0,1,.88.6,2.3,2.3,0,0,1,.52.81A3.34,3.34,0,0,1,28,52.06a2.37,2.37,0,0,1-.9,2,4.31,4.31,0,0,1-2.7.71,8.81,8.81,0,0,1-1.09-.07,7.33,7.33,0,0,1-.87-.18,4.64,4.64,0,0,1-.64-.23,3.33,3.33,0,0,1-.46-.22l.58-1.63a5.89,5.89,0,0,0,1,.4A5.18,5.18,0,0,0,24.35,53Z" />
                <path d="M38.24,50A5.79,5.79,0,0,1,38,51.72a4.27,4.27,0,0,1-.67,1.35,3.77,3.77,0,0,1-1,1,4.23,4.23,0,0,1-1.31.55.81.81,0,0,0,.29.43,1.89,1.89,0,0,0,.57.27,5.13,5.13,0,0,0,.8.16l1,.09L37.22,57a9.3,9.3,0,0,1-1.76-.2,4.28,4.28,0,0,1-1.24-.46,2.31,2.31,0,0,1-.8-.71,3.22,3.22,0,0,1-.46-1,4.88,4.88,0,0,1-1.52-.46,4,4,0,0,1-1.21-.94,4.32,4.32,0,0,1-.8-1.43A5.5,5.5,0,0,1,29.14,50a5.35,5.35,0,0,1,.37-2.07,4.23,4.23,0,0,1,1-1.49A4,4,0,0,1,32,45.52a5.06,5.06,0,0,1,1.74-.31,5.13,5.13,0,0,1,1.76.31,3.84,3.84,0,0,1,1.45.91,4.21,4.21,0,0,1,1,1.49A5.54,5.54,0,0,1,38.24,50Zm-7,0a4.12,4.12,0,0,0,.16,1.21,2.73,2.73,0,0,0,.48.93,2.11,2.11,0,0,0,.76.6,2.4,2.4,0,0,0,1,.21,2.45,2.45,0,0,0,1-.21,2,2,0,0,0,.76-.6A2.73,2.73,0,0,0,36,51.2,4.12,4.12,0,0,0,36.11,50,4.19,4.19,0,0,0,36,48.77a2.69,2.69,0,0,0-.48-.94,2,2,0,0,0-.76-.6,2.45,2.45,0,0,0-1-.21,2.26,2.26,0,0,0-1,.22,2.14,2.14,0,0,0-.76.61,2.64,2.64,0,0,0-.48.93A4.22,4.22,0,0,0,31.26,50Z" />
                <path d="M43.52,54.75a4.62,4.62,0,0,1-1.66-.27,3.11,3.11,0,0,1-1.15-.75A2.89,2.89,0,0,1,40,52.58a4.54,4.54,0,0,1-.22-1.47V45.43h2v5.51a3.18,3.18,0,0,0,.13.94,1.72,1.72,0,0,0,.34.63,1.18,1.18,0,0,0,.53.35,2.11,2.11,0,0,0,.68.11,1.69,1.69,0,0,0,1.22-.46,2.17,2.17,0,0,0,.47-1.57V45.43h2v5.68a4.64,4.64,0,0,1-.22,1.48,3,3,0,0,1-1.86,1.9A5,5,0,0,1,43.52,54.75Z" />
                <path d="M55.14,54.56c-.1-.31-.21-.64-.33-1s-.23-.67-.35-1H50.89c-.11.33-.23.66-.34,1s-.23.66-.33,1H48.09c.34-1,.67-1.89,1-2.73s.62-1.62.91-2.36l.87-2.1c.29-.66.59-1.31.9-1.94h1.95c.3.63.59,1.28.88,1.94s.59,1.37.89,2.1.59,1.53.9,2.36.64,1.75,1,2.73ZM52.67,47.5c-.05.13-.11.31-.2.54s-.19.49-.3.79-.24.63-.38,1-.29.74-.43,1.13H54l-.4-1.13c-.13-.37-.26-.7-.38-1s-.22-.56-.31-.79Z" />
                <path d="M61.19,45.32a5.62,5.62,0,0,1,3.15.73,2.56,2.56,0,0,1,1.1,2.28A2.6,2.6,0,0,1,65,49.89a3,3,0,0,1-1.27.94c.18.23.37.49.58.79s.4.6.6.92.38.66.57,1,.35.69.51,1h-2.3c-.16-.29-.33-.6-.51-.91s-.34-.6-.53-.89l-.53-.83a8.51,8.51,0,0,0-.53-.7h-1v3.33h-2v-9a11.94,11.94,0,0,1,1.39-.19C60.39,45.34,60.82,45.32,61.19,45.32Zm.12,1.75-.4,0-.34,0v2.48h.58a3.46,3.46,0,0,0,1.67-.29,1,1,0,0,0,.5-1,1,1,0,0,0-.51-1A3.14,3.14,0,0,0,61.31,47.07Z" />
                <path d="M67.31,54.56V45.43h6.17v1.72H69.37V49H73v1.68H69.37v2.21h4.42v1.72Z" />
              </g>
            </g>
          </svg>
        </div>
        <Flipper
          flipKey={selected}
          decisionData={selected}
          spring="gentle"
          staggerConfig={{
            list: {
              speed: 1
            }
          }}
        >
          <Route
            path="/:id"
            render={props => <Detail {...props} index={selected} />}
          />

          <div className="list-container">
            {Object.keys(sobayas).map((sobayaId, index) => (
              <div
                className="item-wrapper"
                key={index}
                onClick={e => this.handleClick(e, index)}
              >
                {selected === index ? (
                  <Route
                    path="/"
                    render={props => (
                      <ExpandedListItem
                        {...props}
                        sobaya={sobayas[sobayaId]}
                        index={index}
                      />
                    )}
                  />
                ) : (
                  <Route
                    path="/"
                    render={props => (
                      <ListItem
                        {...props}
                        sobaya={sobayas[sobayaId]}
                        index={index}
                      />
                    )}
                  />
                )}
              </div>
            ))}
          </div>
        </Flipper>
      </div>
    );
  }
}

export default List;
